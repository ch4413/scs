from pytest import mark
from scsavailability import results as rs
import pandas as pd
import numpy as np
import pkg_resources

@mark.package
@mark.results
class ResultsTests:
    
    def test_create_output(self):

        fa_PTT = {'PTT011':pd.DataFrame({'Alert ID': {1: 1.0, 2: 1.0, 0: 3.0, 3: 4.0, 4: 4.0, 6: 2.0},
                                            'Number': {1: '2', 2: '2', 0: '4', 3: '5', 4: '5', 6: '3'},
                                            'Alert': {1: 'C05: C05PTT011_ external unit fault',
                                            2: 'C05: C05PTT011_ external unit fault',
                                            0: 'C15: C1502RDC070 070B11 occupancy sensor fault',
                                            3: 'C23: C2301RDC176 176B14 occupancy sensor fault',
                                            4: 'C23: C2301RDC176 176B14 occupancy sensor fault',
                                            6: 'C16: C1603STA253 253B12 occupancy sensor fault'},
                                            'timestamp': {1: pd.to_datetime('2021-01-09 08:00:00'),
                                            2: pd.to_datetime('2021-01-09 09:00:00'),
                                            0: pd.to_datetime('2021-01-09 08:00:00'),
                                            3: pd.to_datetime('2021-01-10 07:00:00'),
                                            4: pd.to_datetime('2021-01-10 08:00:00'),
                                            6: pd.to_datetime('2021-01-11 08:00:00')},
                                            'PLC': {1: 'C05', 2: 'C05', 0: 'C15', 3: 'C23', 4: 'C23', 6: 'C16'},
                                            'Desk': {1: 'Z', 2: 'Z', 0: 'P02', 3: 'P01', 4: 'P01', 6: 'P03'},
                                            'Duration': {1: 6.480638923341991,
                                            2: 5.499809670330265,
                                            0: 7.835184586147302,
                                            3: 5.0943445622221,
                                            4: 8.512071245835466,
                                            6: 7.0867747269123065},
                                            'Fault ID': {1: 3611.0,
                                            2: 3611.0,
                                            0: 3416.0,
                                            3: 3416.0,
                                            4: 3416.0,
                                            6: 3416.0},
                                            'Asset Code': {1: 'C05PTT011',
                                            2: 'C05PTT011',
                                            0: 'C1502RDC070',
                                            3: 'C2301RDC176',
                                            4: 'C2301RDC176',
                                            6: 'C1603STA253'},
                                            'Area': {1: 'PTT', 2: 'PTT', 0: 'C15', 3: 'C23', 4: 'C23', 6: 'C16'},
                                            'Tote Colour': {1: 'Both',
                                            2: 'Both',
                                            0: 'Blue',
                                            3: 'Blue',
                                            4: 'Blue',
                                            6: 'Blue'},
                                            'Loop': {1: np.NaN,
                                            2: np.NaN,
                                            0: 'Outside',
                                            3: 'Outside',
                                            4: 'Outside',
                                            6: 'Outside'},
                                            'Suffix': {1: np.NaN, 2: np.NaN, 0: 'C1502', 3: 'C2301', 4: 'C2301', 6: 'C1603'},
                                            'PLCN': {1: 5.0, 2: 5.0, 0: 15.0, 3: 23.0, 4: 23.0, 6: 16.0},
                                            'Quadrant': {1: 1.0, 2: 1.0, 0: 0.0, 3: 0.0, 4: 0.0, 6: 0.0},
                                            'MODULE': {1: '1', 2: '1', 0: np.NaN, 3: np.NaN, 4: np.NaN, 6: np.NaN},
                                            'Alert Type': {1: 'Fault',
                                            2: 'Fault',
                                            0: 'Fault',
                                            3: 'Fault',
                                            4: 'Fault',
                                            6: 'Fault'},
                                            'Entry Time': {1: pd.to_datetime('2021-01-09 08:56:00'),
                                            2: pd.to_datetime('2021-01-09 09:00:00'),
                                            0: pd.to_datetime('2021-01-09 08:20:00'),
                                            3: pd.to_datetime('2021-01-10 07:59:00'),
                                            4: pd.to_datetime('2021-01-10 08:00:00'),
                                            6: pd.to_datetime('2021-01-11 08:34:00')},
                                            'End Time': {1: pd.to_datetime('2021-01-09 09:00:00'),
                                            2: pd.to_datetime('2021-01-09 09:01:30'),
                                            0: pd.to_datetime('2021-01-09 08:35:30'),
                                            3: pd.to_datetime('2021-01-10 08:00:00'),
                                            4: pd.to_datetime('2021-01-10 08:30:30'),
                                            6: pd.to_datetime('2021-01-11 08:41:20')},
                                            'Pick Station': {1: 'PTT011',
                                            2: 'PTT011',
                                            0: False,
                                            3: False,
                                            4: False,
                                            6: False}}),                                 
                    'PTT051': pd.DataFrame({'Alert ID': {0: 3.0, 3: 4.0, 4: 4.0, 6: 2.0},
                                'Number': {0: '4', 3: '5', 4: '5', 6: '3'},
                                'Alert': {0: 'C15: C1502RDC070 070B11 occupancy sensor fault',
                                3: 'C23: C2301RDC176 176B14 occupancy sensor fault',
                                4: 'C23: C2301RDC176 176B14 occupancy sensor fault',
                                6: 'C16: C1603STA253 253B12 occupancy sensor fault'},
                                'timestamp': {0: pd.to_datetime('2021-01-09 08:00:00'),
                                3: pd.to_datetime('2021-01-10 07:00:00'),
                                4: pd.to_datetime('2021-01-10 08:00:00'),
                                6: pd.to_datetime('2021-01-11 08:00:00')},
                                'PLC': {0: 'C15', 3: 'C23', 4: 'C23', 6: 'C16'},
                                'Desk': {0: 'P02', 3: 'P01', 4: 'P01', 6: 'P03'},
                                'Duration': {0: 7.835184586147302,
                                3: 5.0943445622221,
                                4: 8.512071245835466,
                                6: 7.0867747269123065},
                                'Fault ID': {0: 3416.0, 3: 3416.0, 4: 3416.0, 6: 3416.0},
                                'Asset Code': {0: 'C1502RDC070',
                                3: 'C2301RDC176',
                                4: 'C2301RDC176',
                                6: 'C1603STA253'},
                                'Area': {0: 'C15', 3: 'C23', 4: 'C23', 6: 'C16'},
                                'Tote Colour': {0: 'Blue', 3: 'Blue', 4: 'Blue', 6: 'Blue'},
                                'Loop': {0: 'Outside', 3: 'Outside', 4: 'Outside', 6: 'Outside'},
                                'Suffix': {0: 'C1502', 3: 'C2301', 4: 'C2301', 6: 'C1603'},
                                'PLCN': {0: 15.0, 3: 23.0, 4: 23.0, 6: 16.0},
                                'Quadrant': {0: 0.0, 3: 0.0, 4: 0.0, 6: 0.0},
                                'MODULE': {0: np.NaN, 3: np.NaN, 4: np.NaN, 6: np.NaN},
                                'Alert Type': {0: 'Fault', 3: 'Fault', 4: 'Fault', 6: 'Fault'},
                                'Entry Time': {0: pd.to_datetime('2021-01-09 08:20:00'),
                                3: pd.to_datetime('2021-01-10 07:59:00'),
                                4: pd.to_datetime('2021-01-10 08:00:00'),
                                6: pd.to_datetime('2021-01-11 08:34:00')},
                                'End Time': {0: pd.to_datetime('2021-01-09 08:35:30'),
                                3: pd.to_datetime('2021-01-10 08:00:00'),
                                4: pd.to_datetime('2021-01-10 08:30:30'),
                                6: pd.to_datetime('2021-01-11 08:41:20')},
                                'Pick Station': {0: False, 3: False, 4: False, 6: False}}),
                    'PTT072': pd.DataFrame({'Alert ID': {0: 3.0, 3: 4.0, 4: 4.0, 6: 2.0},
                                'Number': {0: '4', 3: '5', 4: '5', 6: '3'},
                                'Alert': {0: 'C15: C1502RDC070 070B11 occupancy sensor fault',
                                3: 'C23: C2301RDC176 176B14 occupancy sensor fault',
                                4: 'C23: C2301RDC176 176B14 occupancy sensor fault',
                                6: 'C16: C1603STA253 253B12 occupancy sensor fault'},
                                'timestamp': {0: pd.to_datetime('2021-01-09 08:00:00'),
                                3: pd.to_datetime('2021-01-10 07:00:00'),
                                4: pd.to_datetime('2021-01-10 08:00:00'),
                                6: pd.to_datetime('2021-01-11 08:00:00')},
                                'PLC': {0: 'C15', 3: 'C23', 4: 'C23', 6: 'C16'},
                                'Desk': {0: 'P02', 3: 'P01', 4: 'P01', 6: 'P03'},
                                'Duration': {0: 7.835184586147302,
                                3: 5.0943445622221,
                                4: 8.512071245835466,
                                6: 7.0867747269123065},
                                'Fault ID': {0: 3416.0, 3: 3416.0, 4: 3416.0, 6: 3416.0},
                                'Asset Code': {0: 'C1502RDC070',
                                3: 'C2301RDC176',
                                4: 'C2301RDC176',
                                6: 'C1603STA253'},
                                'Area': {0: 'C15', 3: 'C23', 4: 'C23', 6: 'C16'},
                                'Tote Colour': {0: 'Blue', 3: 'Blue', 4: 'Blue', 6: 'Blue'},
                                'Loop': {0: 'Outside', 3: 'Outside', 4: 'Outside', 6: 'Outside'},
                                'Suffix': {0: 'C1502', 3: 'C2301', 4: 'C2301', 6: 'C1603'},
                                'PLCN': {0: 15.0, 3: 23.0, 4: 23.0, 6: 16.0},
                                'Quadrant': {0: 0.0, 3: 0.0, 4: 0.0, 6: 0.0},
                                'MODULE': {0: np.NaN, 3: np.NaN, 4: np.NaN, 6: np.NaN},
                                'Alert Type': {0: 'Fault', 3: 'Fault', 4: 'Fault', 6: 'Fault'},
                                'Entry Time': {0: pd.to_datetime('2021-01-09 08:20:00'),
                                3: pd.to_datetime('2021-01-10 07:59:00'),
                                4: pd.to_datetime('2021-01-10 08:00:00'),
                                6: pd.to_datetime('2021-01-11 08:34:00')},
                                'End Time': {0: pd.to_datetime('2021-01-09 08:35:30'),
                                3: pd.to_datetime('2021-01-10 08:00:00'),
                                4: pd.to_datetime('2021-01-10 08:30:30'),
                                6: pd.to_datetime('2021-01-11 08:41:20')},
                                'Pick Station': {0: False, 3: False, 4: False, 6: False}}),
                    'PTT112': pd.DataFrame({'Alert ID': {7: 0.0, 8: 9.0, 0: 3.0, 3: 4.0, 4: 4.0, 6: 2.0},
                                            'Number': {7: '1', 8: '10', 0: '4', 3: '5', 4: '5', 6: '3'},
                                            'Alert': {7: 'SCS116: sto: timeout bin from lifter to car X:5 Y:4 S:2 [13.1] ',
                                            8: 'C10: C1002STA081 081B15 clearance sensor fault',
                                            0: 'C15: C1502RDC070 070B11 occupancy sensor fault',
                                            3: 'C23: C2301RDC176 176B14 occupancy sensor fault',
                                            4: 'C23: C2301RDC176 176B14 occupancy sensor fault',
                                            6: 'C16: C1603STA253 253B12 occupancy sensor fault'},
                                            'timestamp': {7: pd.to_datetime('2021-01-12 08:00:00'),
                                            8: pd.to_datetime('2021-01-12 08:00:00'),
                                            0: pd.to_datetime('2021-01-09 08:00:00'),
                                            3: pd.to_datetime('2021-01-10 07:00:00'),
                                            4: pd.to_datetime('2021-01-10 08:00:00'),
                                            6: pd.to_datetime('2021-01-11 08:00:00')},
                                            'PLC': {7: 'SCSM11', 8: 'C10', 0: 'C15', 3: 'C23', 4: 'C23', 6: 'C16'},
                                            'Desk': {7: 'SCS116', 8: 'P02', 0: 'P02', 3: 'P01', 4: 'P01', 6: 'P03'},
                                            'Duration': {7: 4.401197381662156,
                                            8: 2.09861228866811,
                                            0: 7.835184586147302,
                                            3: 5.0943445622221,
                                            4: 8.512071245835466,
                                            6: 7.0867747269123065},
                                            'Fault ID': {7: 5105.0,
                                            8: 3419.0,
                                            0: 3416.0,
                                            3: 3416.0,
                                            4: 3416.0,
                                            6: 3416.0},
                                            'Asset Code': {7: 'SCS116',
                                            8: 'C1002STA081',
                                            0: 'C1502RDC070',
                                            3: 'C2301RDC176',
                                            4: 'C2301RDC176',
                                            6: 'C1603STA253'},
                                            'Area': {7: 'Carousel',
                                            8: 'Module Loop Grey',
                                            0: 'C15',
                                            3: 'C23',
                                            4: 'C23',
                                            6: 'C16'},
                                            'Tote Colour': {7: 'Grey',
                                            8: 'Grey',
                                            0: 'Blue',
                                            3: 'Blue',
                                            4: 'Blue',
                                            6: 'Blue'},
                                            'Loop': {7: 'carousel',
                                            8: 'Module',
                                            0: 'Outside',
                                            3: 'Outside',
                                            4: 'Outside',
                                            6: 'Outside'},
                                            'Suffix': {7: 'SCSM11',
                                            8: 'C1002',
                                            0: 'C1502',
                                            3: 'C2301',
                                            4: 'C2301',
                                            6: 'C1603'},
                                            'PLCN': {7: 0.0, 8: 10.0, 0: 15.0, 3: 23.0, 4: 23.0, 6: 16.0},
                                            'Quadrant': {7: 3.0, 8: 3.0, 0: 0.0, 3: 0.0, 4: 0.0, 6: 0.0},
                                            'MODULE': {7: '11', 8: '11', 0: np.NaN, 3: np.NaN, 4: np.NaN, 6: np.NaN},
                                            'Alert Type': {7: 'Fault',
                                            8: 'Fault',
                                            0: 'Fault',
                                            3: 'Fault',
                                            4: 'Fault',
                                            6: 'Fault'},
                                            'Entry Time': {7: pd.to_datetime('2021-01-12 08:12:00'),
                                            8: pd.to_datetime('2021-01-12 08:01:00'),
                                            0: pd.to_datetime('2021-01-09 08:20:00'),
                                            3: pd.to_datetime('2021-01-10 07:59:00'),
                                            4: pd.to_datetime('2021-01-10 08:00:00'),
                                            6: pd.to_datetime('2021-01-11 08:34:00')},
                                            'End Time': {7: pd.to_datetime('2021-01-12 08:12:30'),
                                            8: pd.to_datetime('2021-01-12 08:01:03'),
                                            0: pd.to_datetime('2021-01-09 08:35:30'),
                                            3: pd.to_datetime('2021-01-10 08:00:00'),
                                            4: pd.to_datetime('2021-01-10 08:30:30'),
                                            6: pd.to_datetime('2021-01-11 08:41:20')},
                                            'Pick Station': {7: False, 8: False, 0: False, 3: False, 4: False, 6: False}}),
                    'PTT202':pd.DataFrame({'Alert ID': {9: 5.0, 10: 5.0, 0: 3.0, 3: 4.0, 4: 4.0, 6: 2.0},
                                            'Number': {9: '6', 10: '6', 0: '4', 3: '5', 4: '5', 6: '3'},
                                            'Alert': {9: 'SCS M20: single module 1 emergency stop unit     [24.0]',
                                            10: 'SCS M20: single module 1 emergency stop unit     [24.0]',
                                            0: 'C15: C1502RDC070 070B11 occupancy sensor fault',
                                            3: 'C23: C2301RDC176 176B14 occupancy sensor fault',
                                            4: 'C23: C2301RDC176 176B14 occupancy sensor fault',
                                            6: 'C16: C1603STA253 253B12 occupancy sensor fault'},
                                            'timestamp': {9: pd.to_datetime('2021-01-13 08:00:00'),
                                            10: pd.to_datetime('2021-01-13 09:00:00'),
                                            0: pd.to_datetime('2021-01-09 08:00:00'),
                                            3: pd.to_datetime('2021-01-10 07:00:00'),
                                            4: pd.to_datetime('2021-01-10 08:00:00'),
                                            6: pd.to_datetime('2021-01-11 08:00:00')},
                                            'PLC': {9: 'SCSM20', 10: 'SCSM20', 0: 'C15', 3: 'C23', 4: 'C23', 6: 'C16'},
                                            'Desk': {9: 'SCSM20', 10: 'SCSM20', 0: 'P02', 3: 'P01', 4: 'P01', 6: 'P03'},
                                            'Duration': {9: 8.922985958711195,
                                            10: 8.371489295214278,
                                            0: 7.835184586147302,
                                            3: 5.0943445622221,
                                            4: 8.512071245835466,
                                            6: 7.0867747269123065},
                                            'Fault ID': {9: 5416.0,
                                            10: 5416.0,
                                            0: 3416.0,
                                            3: 3416.0,
                                            4: 3416.0,
                                            6: 3416.0},
                                            'Asset Code': {9: 'SCSM20',
                                            10: 'SCSM20',
                                            0: 'C1502RDC070',
                                            3: 'C2301RDC176',
                                            4: 'C2301RDC176',
                                            6: 'C1603STA253'},
                                            'Area': {9: 'Carousel',
                                            10: 'Carousel',
                                            0: 'C15',
                                            3: 'C23',
                                            4: 'C23',
                                            6: 'C16'},
                                            'Tote Colour': {9: 'Grey',
                                            10: 'Grey',
                                            0: 'Blue',
                                            3: 'Blue',
                                            4: 'Blue',
                                            6: 'Blue'},
                                            'Loop': {9: 'carousel',
                                            10: 'carousel',
                                            0: 'Outside',
                                            3: 'Outside',
                                            4: 'Outside',
                                            6: 'Outside'},
                                            'Suffix': {9: 'SCSM20',
                                            10: 'SCSM20',
                                            0: 'C1502',
                                            3: 'C2301',
                                            4: 'C2301',
                                            6: 'C1603'},
                                            'PLCN': {9: 0.0, 10: 0.0, 0: 15.0, 3: 23.0, 4: 23.0, 6: 16.0},
                                            'Quadrant': {9: 4.0, 10: 4.0, 0: 0.0, 3: 0.0, 4: 0.0, 6: 0.0},
                                            'MODULE': {9: '20', 10: '20', 0: np.NaN, 3: np.NaN, 4: np.NaN, 6: np.NaN},
                                            'Alert Type': {9: 'Fault',
                                            10: 'Fault',
                                            0: 'Fault',
                                            3: 'Fault',
                                            4: 'Fault',
                                            6: 'Fault'},
                                            'Entry Time': {9: pd.to_datetime('2021-01-13 08:14:00'),
                                            10: pd.to_datetime('2021-01-13 09:00:00'),
                                            0: pd.to_datetime('2021-01-09 08:20:00'),
                                            3: pd.to_datetime('2021-01-10 07:59:00'),
                                            4: pd.to_datetime('2021-01-10 08:00:00'),
                                            6: pd.to_datetime('2021-01-11 08:34:00')},
                                            'End Time': {9: pd.to_datetime('2021-01-13 09:00:00'),
                                            10: pd.to_datetime('2021-01-13 09:26:30'),
                                            0: pd.to_datetime('2021-01-09 08:35:30'),
                                            3: pd.to_datetime('2021-01-10 08:00:00'),
                                            4: pd.to_datetime('2021-01-10 08:30:30'),
                                            6: pd.to_datetime('2021-01-11 08:41:20')},
                                            'Pick Station': {9: False, 10: False, 0: False, 3: False, 4: False, 6: False}})}
        
        coeff = pd.DataFrame({'Asset Code': {0: 'C1502RDC070',
                                                    1: 'C2301RDC176',
                                                    2: 'C1603STA253',
                                                    3: 'SCSM20'},
                                        'Coefficient': {0: -0.0001,
                                                    1: -0.002,
                                                    2: -0.04,
                                                    3: -0.005}})

        report_start = pd.to_datetime('2021-01-01 00:00:00')
        report_end = pd.to_datetime('2022-01-01 00:00:00')

        Output = rs.create_output(fa_PTT, coeff, report_start, report_end)

        Output_expected = pd.DataFrame({'NUMBER': {0: '4',
                                                    1: '5',
                                                    2: '5',
                                                    3: '3',
                                                    4: '4',
                                                    5: '5',
                                                    6: '5',
                                                    7: '3',
                                                    8: '4',
                                                    9: '5',
                                                    10: '5',
                                                    11: '3',
                                                    12: '4',
                                                    13: '5',
                                                    14: '5',
                                                    15: '3',
                                                    16: '6',
                                                    17: '6',
                                                    18: '4',
                                                    19: '5',
                                                    20: '5',
                                                    21: '3'},
                                                    'ALERT': {0: 'C15: C1502RDC070 070B11 occupancy sensor fault',
                                                    1: 'C23: C2301RDC176 176B14 occupancy sensor fault',
                                                    2: 'C23: C2301RDC176 176B14 occupancy sensor fault',
                                                    3: 'C16: C1603STA253 253B12 occupancy sensor fault',
                                                    4: 'C15: C1502RDC070 070B11 occupancy sensor fault',
                                                    5: 'C23: C2301RDC176 176B14 occupancy sensor fault',
                                                    6: 'C23: C2301RDC176 176B14 occupancy sensor fault',
                                                    7: 'C16: C1603STA253 253B12 occupancy sensor fault',
                                                    8: 'C15: C1502RDC070 070B11 occupancy sensor fault',
                                                    9: 'C23: C2301RDC176 176B14 occupancy sensor fault',
                                                    10: 'C23: C2301RDC176 176B14 occupancy sensor fault',
                                                    11: 'C16: C1603STA253 253B12 occupancy sensor fault',
                                                    12: 'C15: C1502RDC070 070B11 occupancy sensor fault',
                                                    13: 'C23: C2301RDC176 176B14 occupancy sensor fault',
                                                    14: 'C23: C2301RDC176 176B14 occupancy sensor fault',
                                                    15: 'C16: C1603STA253 253B12 occupancy sensor fault',
                                                    16: 'SCS M20: single module 1 emergency stop unit     [24.0]',
                                                    17: 'SCS M20: single module 1 emergency stop unit     [24.0]',
                                                    18: 'C15: C1502RDC070 070B11 occupancy sensor fault',
                                                    19: 'C23: C2301RDC176 176B14 occupancy sensor fault',
                                                    20: 'C23: C2301RDC176 176B14 occupancy sensor fault',
                                                    21: 'C16: C1603STA253 253B12 occupancy sensor fault'},
                                                    'ENTRY_TIME': {0: pd.to_datetime('2021-01-09 08:20:00'),
                                                    1: pd.to_datetime('2021-01-10 07:59:00'),
                                                    2: pd.to_datetime('2021-01-10 08:00:00'),
                                                    3: pd.to_datetime('2021-01-11 08:34:00'),
                                                    4: pd.to_datetime('2021-01-09 08:20:00'),
                                                    5: pd.to_datetime('2021-01-10 07:59:00'),
                                                    6: pd.to_datetime('2021-01-10 08:00:00'),
                                                    7: pd.to_datetime('2021-01-11 08:34:00'),
                                                    8: pd.to_datetime('2021-01-09 08:20:00'),
                                                    9: pd.to_datetime('2021-01-10 07:59:00'),
                                                    10: pd.to_datetime('2021-01-10 08:00:00'),
                                                    11: pd.to_datetime('2021-01-11 08:34:00'),
                                                    12: pd.to_datetime('2021-01-09 08:20:00'),
                                                    13: pd.to_datetime('2021-01-10 07:59:00'),
                                                    14: pd.to_datetime('2021-01-10 08:00:00'),
                                                    15: pd.to_datetime('2021-01-11 08:34:00'),
                                                    16: pd.to_datetime('2021-01-13 08:14:00'),
                                                    17: pd.to_datetime('2021-01-13 09:00:00'),
                                                    18: pd.to_datetime('2021-01-09 08:20:00'),
                                                    19: pd.to_datetime('2021-01-10 07:59:00'),
                                                    20: pd.to_datetime('2021-01-10 08:00:00'),
                                                    21: pd.to_datetime('2021-01-11 08:34:00')},
                                                    'END_TIME': {0: pd.to_datetime('2021-01-09 08:35:30'),
                                                    1: pd.to_datetime('2021-01-10 08:00:00'),
                                                    2: pd.to_datetime('2021-01-10 08:30:30'),
                                                    3: pd.to_datetime('2021-01-11 08:41:20'),
                                                    4: pd.to_datetime('2021-01-09 08:35:30'),
                                                    5: pd.to_datetime('2021-01-10 08:00:00'),
                                                    6: pd.to_datetime('2021-01-10 08:30:30'),
                                                    7: pd.to_datetime('2021-01-11 08:41:20'),
                                                    8: pd.to_datetime('2021-01-09 08:35:30'),
                                                    9: pd.to_datetime('2021-01-10 08:00:00'),
                                                    10: pd.to_datetime('2021-01-10 08:30:30'),
                                                    11: pd.to_datetime('2021-01-11 08:41:20'),
                                                    12: pd.to_datetime('2021-01-09 08:35:30'),
                                                    13: pd.to_datetime('2021-01-10 08:00:00'),
                                                    14: pd.to_datetime('2021-01-10 08:30:30'),
                                                    15: pd.to_datetime('2021-01-11 08:41:20'),
                                                    16: pd.to_datetime('2021-01-13 09:00:00'),
                                                    17: pd.to_datetime('2021-01-13 09:26:30'),
                                                    18: pd.to_datetime('2021-01-09 08:35:30'),
                                                    19: pd.to_datetime('2021-01-10 08:00:00'),
                                                    20: pd.to_datetime('2021-01-10 08:30:30'),
                                                    21: pd.to_datetime('2021-01-11 08:41:20')},
                                                    'PLC': {0: 'C15',
                                                    1: 'C23',
                                                    2: 'C23',
                                                    3: 'C16',
                                                    4: 'C15',
                                                    5: 'C23',
                                                    6: 'C23',
                                                    7: 'C16',
                                                    8: 'C15',
                                                    9: 'C23',
                                                    10: 'C23',
                                                    11: 'C16',
                                                    12: 'C15',
                                                    13: 'C23',
                                                    14: 'C23',
                                                    15: 'C16',
                                                    16: 'SCSM20',
                                                    17: 'SCSM20',
                                                    18: 'C15',
                                                    19: 'C23',
                                                    20: 'C23',
                                                    21: 'C16'},
                                                    'DESK': {0: 'P02',
                                                    1: 'P01',
                                                    2: 'P01',
                                                    3: 'P03',
                                                    4: 'P02',
                                                    5: 'P01',
                                                    6: 'P01',
                                                    7: 'P03',
                                                    8: 'P02',
                                                    9: 'P01',
                                                    10: 'P01',
                                                    11: 'P03',
                                                    12: 'P02',
                                                    13: 'P01',
                                                    14: 'P01',
                                                    15: 'P03',
                                                    16: 'SCSM20',
                                                    17: 'SCSM20',
                                                    18: 'P02',
                                                    19: 'P01',
                                                    20: 'P01',
                                                    21: 'P03'},
                                                    'FAULT_ID': {0: 3416.0,
                                                    1: 3416.0,
                                                    2: 3416.0,
                                                    3: 3416.0,
                                                    4: 3416.0,
                                                    5: 3416.0,
                                                    6: 3416.0,
                                                    7: 3416.0,
                                                    8: 3416.0,
                                                    9: 3416.0,
                                                    10: 3416.0,
                                                    11: 3416.0,
                                                    12: 3416.0,
                                                    13: 3416.0,
                                                    14: 3416.0,
                                                    15: 3416.0,
                                                    16: 5416.0,
                                                    17: 5416.0,
                                                    18: 3416.0,
                                                    19: 3416.0,
                                                    20: 3416.0,
                                                    21: 3416.0},
                                                    'ID': {0: 'C1502RDC070',
                                                    1: 'C2301RDC176',
                                                    2: 'C2301RDC176',
                                                    3: 'C1603STA253',
                                                    4: 'C1502RDC070',
                                                    5: 'C2301RDC176',
                                                    6: 'C2301RDC176',
                                                    7: 'C1603STA253',
                                                    8: 'C1502RDC070',
                                                    9: 'C2301RDC176',
                                                    10: 'C2301RDC176',
                                                    11: 'C1603STA253',
                                                    12: 'C1502RDC070',
                                                    13: 'C2301RDC176',
                                                    14: 'C2301RDC176',
                                                    15: 'C1603STA253',
                                                    16: 'SCSM20',
                                                    17: 'SCSM20',
                                                    18: 'C1502RDC070',
                                                    19: 'C2301RDC176',
                                                    20: 'C2301RDC176',
                                                    21: 'C1603STA253'},
                                                    'AREA': {0: 'C15',
                                                    1: 'C23',
                                                    2: 'C23',
                                                    3: 'C16',
                                                    4: 'C15',
                                                    5: 'C23',
                                                    6: 'C23',
                                                    7: 'C16',
                                                    8: 'C15',
                                                    9: 'C23',
                                                    10: 'C23',
                                                    11: 'C16',
                                                    12: 'C15',
                                                    13: 'C23',
                                                    14: 'C23',
                                                    15: 'C16',
                                                    16: 'Carousel',
                                                    17: 'Carousel',
                                                    18: 'C15',
                                                    19: 'C23',
                                                    20: 'C23',
                                                    21: 'C16'},
                                                    'BLUEGREY': {0: 'Blue',
                                                    1: 'Blue',
                                                    2: 'Blue',
                                                    3: 'Blue',
                                                    4: 'Blue',
                                                    5: 'Blue',
                                                    6: 'Blue',
                                                    7: 'Blue',
                                                    8: 'Blue',
                                                    9: 'Blue',
                                                    10: 'Blue',
                                                    11: 'Blue',
                                                    12: 'Blue',
                                                    13: 'Blue',
                                                    14: 'Blue',
                                                    15: 'Blue',
                                                    16: 'Grey',
                                                    17: 'Grey',
                                                    18: 'Blue',
                                                    19: 'Blue',
                                                    20: 'Blue',
                                                    21: 'Blue'},
                                                    'PTT': {0: 'PTT011',
                                                    1: 'PTT011',
                                                    2: 'PTT011',
                                                    3: 'PTT011',
                                                    4: 'PTT051',
                                                    5: 'PTT051',
                                                    6: 'PTT051',
                                                    7: 'PTT051',
                                                    8: 'PTT072',
                                                    9: 'PTT072',
                                                    10: 'PTT072',
                                                    11: 'PTT072',
                                                    12: 'PTT112',
                                                    13: 'PTT112',
                                                    14: 'PTT112',
                                                    15: 'PTT112',
                                                    16: 'PTT202',
                                                    17: 'PTT202',
                                                    18: 'PTT202',
                                                    19: 'PTT202',
                                                    20: 'PTT202',
                                                    21: 'PTT202'},
                                                    'SINGLES': {0: 0.23792869977215927,
                                                    1: 3.093968660352597,
                                                    2: 5.169670278018237,
                                                    3: 86.08078483989117,
                                                    4: 0.23792869977215927,
                                                    5: 3.093968660352597,
                                                    6: 5.169670278018237,
                                                    7: 86.08078483989117,
                                                    8: 0.23792869977215927,
                                                    9: 3.093968660352597,
                                                    10: 5.169670278018237,
                                                    11: 86.08078483989117,
                                                    12: 0.23792869977215927,
                                                    13: 3.093968660352597,
                                                    14: 5.169670278018237,
                                                    15: 86.08078483989117,
                                                    16: 13.54808188561976,
                                                    17: 12.71072519904917,
                                                    18: 0.23792869977215927,
                                                    19: 3.093968660352597,
                                                    20: 5.169670278018237,
                                                    21: 86.08078483989117}})

        assert Output.equals(Output_expected)